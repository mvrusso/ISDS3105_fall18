---
title: "Assignment 3"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!require(fivethirtyeight)) {install.packages('fivethirtyeight')}
library(fivethirtyeight)
```

For this assignment we are using a dataset from the website [Fivethirtyeight](http://fivethirtyeight.com/). All these datasets are available on their [GitHub page](https://github.com/fivethirtyeight/data/) and in the `fivethirtyeight` package.

1. Install and load the `fivethirtyeight` library. For this assigment we are using the dataset `bad_drivers`.

2. In the narrative, add a brief description (`?bad_drivers` for a description of the dataset) using *inline code* to show the variable names.

```{r echo=TRUE}
#This dataset is used to determine which state has the worst drivers.  

bad_drivers$num_drivers
#This variable gives the number of drivers involved in fatal collisions per billion miles.

bad_drivers$perc_speeding
#This variable gives the percentage of drivers involved in fatal collisions who were speeding.

bad_drivers$perc_alcohol
#This variable gives the percentage of drivers involved in fatal collisions who were alcohol-impaired.

bad_drivers$perc_not_distracted
#This is the percentage of drivers involved in fatal collisions who were not distracted.

bad_drivers$perc_no_previous
#This is the percentage of drivers involved in fatal collisions who were not in any previous accidents.

bad_drivers$insurance_premiums
#This variable is the car insurance premiums.

bad_drivers$losses
#This variable gives the losses incurred by insurance companies for collisions per insured driver.
```


3. Plot a dot chart of premiums by losses. Map the count of drivers to the size of the dots.

```{r echo=FALSE}
ggplot(data = bad_drivers)+
  geom_point(aes(x = insurance_premiums, y = losses, size = num_drivers))+
  ggtitle('Bad Drivers')
```


4. Test what values from `state` are equal to "Louisiana" and assign the output to a new variable called `Louisiana' (logical)

```{r}
Louisiana <- bad_drivers$state == 'Louisiana'
```


5. Map the variable "Louisiana" to `color`. That way, the dot referring to Louisiana should have a different color.

```{r echo=FALSE}
ggplot(data = bad_drivers)+
  geom_point(aes(x = insurance_premiums, y = losses, size = num_drivers, color = Louisiana))+
  ggtitle('Louisiana Drivers Compared With Others')
```


6. In your narrative, use inline code to report the average insurance premium and count of losses in US, and the premium and losses in Louisiana. Do not type those values manually, but extract them from the dataset using inline code.

```{r}
avg_prem <- mean(bad_drivers$insurance_premiums)
sum_loss <- sum(bad_drivers$losses)
LA_prem <- bad_drivers$insurance_premiums[19]
LA_loss <- bad_drivers$losses[19]
```

`r avg_prem`
`r sum_loss`
`r LA_prem`
`r LA_loss`

7. Report in a tabular format the 5 states with the highest premiums (include only state and insurance_premiums)

```{r}
bad_drivers %>% 
  arrange(desc(insurance_premiums)) %>% 
  filter(state == 'New Jersey' | state == 'Louisiana' | state == 'District of Columbia' | state == 'New York' | state == 'Florida') %>% 
  distinct(state, insurance_premiums)
```


8. Reshape the dataset gathering together perc_speeding, perc_alcohol, perc_not_distracted in one variable, paired with their pecentages. Name this variable "ViolationType" and the variable for the value pairs "perc".

```{r}
gather(bad_drivers, key = 'violationType', value = 'perc', perc_speeding, perc_alcohol, perc_not_distracted)
```


9. Use facetting (DO NOT use 3 distinct calls to `ggplot()`) to plot 3 dot plots for the correlation between:

   - insurance_premiums and perc_alcohol
   - insurance_premiums and perc_speeding
   - insurance_premiums and perc_not_distracted
   
```{r}
ggplot(data = bad_drivers)+
  geom_dotplot(aes(x = insurance_premiums, y = losses))+
  facet_wrap(~ violationType)
```
   
   
   
10. Mute the code for both charts and add a title to both. Knit to html.
   
   



